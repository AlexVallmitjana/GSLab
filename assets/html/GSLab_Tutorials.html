<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" href="https://alexvallmitjana.github.io/GSLab/assets/css/style.css">
    <link rel="shortcut icon" type="image/png" href="https://alexvallmitjana.github.io/GSLab/scripts/logo1.png">


<title>Download the tutorial files from FigShare: 
https://doi.org/10.6084/m9.figshare.28067108</title>
<style>
body {
	margin:0;
	padding:0;
	text-align:justify;
	 background:#f2f2f2;
	}
#cap {
position: fixed;
width:100%;
background-color:#212121;
}
p{text-align:center;margin:0px;color:#F2F2F2;}

a{text-align:center;margin:0px; color: #65C;}
a:hover{cursor:pointer;};

#cap2 {
width:100%;
background-color:green;
}
#cos {
    background:#f2f2f2;
    margin:0px auto;
    padding:.68em .68em 1em .68em;  
	max-width:686px;
}

</style>

</head>

<body>
<div id="cap" style="display:none;">
<p><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare:  https://doi.org/10.6084/m9.figshare.28067108</a></p>
</div>
<div id="cap2" style="display:none;">
<p><a>Download the tutorial files from FigShare:  https://doi.org/10.6084/m9.figshare.28067108</a></p>
</div>
<div id="cos">

<h2 id="T1">Tutorial 1 – Basic phasor analysis using lifetime measurement of a human skin biopsy </h2>
<ol start="0">
<em>All tutorials use one of the sample files in the FigShare package, it only needs to be downloaded once.<div style="height: 10px;"></div></em>
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Start GSLab.</li>
<li>Right-click in the empty space and select Load > SimFCS ref.</li>
<li>Select the single ref file from the SkinSlice folder.<br>This is a XZ cross section of an unlabeled human skin biopsy taken at the NLOM lab at UCI.</li>
<li>The phasor plot and the image will appear.</li>
<li>Check/uncheck the file in the main panel to include/exclude it from the phasor plot.</li>
<li>Hover over the phasor to see highlighted image regions.</li>
<li>Use the scroll wheel to adjust the cursor size.</li>
<li>Hover over the image to see the black cursor move on the phasor plot.</li>
<h3>Image tab – Control the rendering of the intensity image</h3>
<li>This image has a very high dynamic range, we can tune a better rendering: Observe the intensity histogram how all the values are in the far left. </li>
<li>Move the Right Intensity Slider halfway to reveal collagen structures.</li>
<li>Move it further (to about 1/8th) to see the epidermis, though some bright pixels may saturate.</li>
<li>Checking/unchecking Excess to zero to exclude bright saturated pixels from the phasor plot.</li>
<li>The image contains many low-photon pixels corresponding to outside the biopsy. We can threshold these pixels out:</li>
<li>Uncheck Relative to show the histogram in real counts.</li>
<li>Set the lower intensity threshold to 30 and press Enter.</li>
<li>The phasor now excludes the pixels with low photon counts: the noisy distribution on the left part of the phasor plot has disappeared.</li>
<h3>Phasor tab – Select the phasor magnitude to measure</h3>
<li>In the bottom section try the different magnitudes and see how the color projection changes. Use TauPhase for this dataset. Each pixel in the image is colored according to the underlying colormap in the phasor.</li>
<h3>Cursors – Place cursors on the phasor plot</h3>
<li>Depending on the settings in the previous sections, the phasor distribution may appear very differently. We may see 1, 2 3 4 or more distinct populations. </li>
<li>Click on the phasor plot to place cursors and color the image accordingly.</li>
<li>Use the red X button (top-right) to remove cursors (appears if one or more cursors are on the phasor plot).</li>
<h3>Export tab – Save images and phasor plots</h3>
<li>Click Output Folder to choose a save location.</li>
<li>Uncheck all checkboxes except for Phasor with axes, Phasor Plot as, Intensity image, Magnitude-colored x intensity, and Combine into single image.</li>
<li>Click Export LR to save the selected items.</li>
<li>A single file will be exported with grayscale intensity, phasor color projection, and the phasor plot.</li>
<li>Uncheck Magnitude-colored x intensity and check the Cursor-Colored image.</li>
<li>Press the Export LR button to export like before but now the image is colored according to any cursors on the phasor plot.</li>
</ol>
<h2 id="T2">Tutorial 2 – Phasor calibration and phasor filtering</h2>
<ol start="0">
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Start GSLab.</li>
<li>Right-click in the empty space and select Load > simFCS ref.</li>
<li>Select the file from the SkinSlice folder.<br>This is a XZ cross section of an unlabeled human skin biopsy taken at the NLOM lab at UCI.</li>
<li>Optionally we can threshold low-photon pixels like in the previous tutorial.<br>(Image tab - increase the lower value for the intensiy range by a little e.g. 0.05 in relative).</li>
<li>Right-click in the empty space and select Load > Trace txt/csv.</li>
<li>Select the Coumarin6 file from the SkinSlice folder.<br>This is a measurement of a Coumarin6 solution taken right before the image of the biopsy.</li>
<li>This file contains a single trace, the software displays it as a single-pixel image in the Image Window. </li>
<li>Check/uncheck each file in the list to see their contributions in the phasor plot.</li>
<li>Hover over the phasor plot or image window to locate the Coumarin6 on the phasor plot.<br>Notice that it is outside of the Universal Circle.</li>
<li>Coumarin6 has a known lifetime of 2.5ns, its phasor position should be on the Universal Circle at the corresponding lifetime. We use this fact to calibrate the phasor coordinates of the biopsy values.</li>
<li>Click on the Coumarin6 file name to select it in blue.</li>
<li>Right-click and select Calibration file.</li>
<li>The Calibration panel unfolds showing the selected file name in the list. </li>
<li>Use the arrow button to expand/collapse the panel.</li>
<li>Enter 2.5 in the Calibration Lifetime (ns) field. Press Enter.</li>
<li>Check the Apply checkbox to shift the phasor plot accordingly.<br>By checking and unchecking the Apply checkbox you can see the phasor position of the calibrated and uncalibrated data</li>
<li>Once set to 2.5ns, we can remove the calibration file:</li>
<li>Uncheck the Coumarin6 filename from the list.</li>
<li>Right-click in the empty space and select Clear > Unchecked.</li>
<h3>Image tab – Control the rendering of the intensity image</h3>
<li>Slide the right slider down to about 1/8th of the range to adjust the image display.</li>
<h3>Phasor tab – Filter the phasor data</h3>
<li>Set Phasor filtering to 1 and press Enter (phasor plot will look noisy).</li>
<li>Set it to 5 and press Enter (reduces noise).</li>
<li>Set Times to 3 and press Enter (further sharpens the phasor).</li>
<li>Higher filtering smooths out regions in the image.</li>
<li>In Measured magnitude, click TauNorm to display the color projection to the Universal Circle.</li>
<li>Adjust Color range to 0 and 0.5 to cover the full semicircle.</li>
<li>Click Auto to let the software adjust the color range automatically.</li>
<h3>Display tab – Customize the phasor plot</h3>
<li>Set Harmonic # to 2 (phasor computed in second harmonic).</li>
<li>Change it back to 1 to return to the first harmonic.</li>
<li>Toggle Lines and Ticks on/off.</li>
<li>Adjust Font sizes.</li>
<li>Toggle Soft Masks to see intensity-based or color-only images.</li>
<h3>Export tab – Save images and phasor plots</h3>
<li>Click Output Folder to select a save location.</li>
<li>Uncheck all checkboxes except for Print colorbar, and Magnitude-colored x intensity.</li>
<li>Click Export LR to save the selected items.</li>
<li>Two image files will be exported the image with phasor lifetime projection, and colorbar with the lifetime values.</li>
</ol>
<h2 id="T3">Tutorial 3 – Phasor calibration in multichannel data</h2>
<ol start="0">
<em>Attention: Ensure that the Promt FLIMlabs load option is checked to allow selecting raw data<br>(Settings tab - Prompt FLIMlabs load option checkbox).<div style="height: 10px;"></div></em>
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Start GSLab.</li>
<li>Right-click in the empty space and select Load > FLIMlabs json.</li>
<li>Select all 6 file from the Convallaria folder.<br>These are 2-channel measurements of Convallaria majalis root samples and two solid calibrator measurements, one for each channel, of a known lifetime of 2.5ns.<br>Courtesy of Alvaro Crevenna, EMBL Roma.</li>
<li>The prompt should appear, select the RAW button.</li>
<li>We have loaded the uncalibrated data which  has a high phase shift and is being depicted in the second and third quadrant.</li>
<h3>Phasor tab – Select the appropriate range for phasor computing</h3>
<li>Set the G range lower and upper values to -1 and +1 respectively.</li>
<li>Set the S range using the auto button.</li>
<h3>Image tab – Control the rendering of the intensity image</h3>
<li>Some images are much brighter; set the intensity range units to relative with the Relative checkbox.</li>
<li>Set the intensity range using the Auto button.</li>
<li>Inspect the distributions on the phasor plot to observe where the calibrator and convallaria samples are at.</li>
<h3>File tab – Calibrate each channel separately</h3>
<li>Select the Solid_calibrator_data_1_1756994363_phasor_ch1.json file (left click on it).</li>
<li>Declare it as a calibration file (Right click - Calibration File).</li>
<li>The calibration panel opens, ener 2.5 in the Calibration Lifetime box.</li>
<li>Check the Apply checkbox to shift all data accordingly. Now the file we selected for calibration should be on the universal circle at the position for 2.5ns.</li>
<li>The selected file has appeared as a line in the calibration panel, with its name on the right, the assigned lifetime in the middle and a text identifier, currently 'all'.</li>
<li>Change the identifier to apply the calibration only to specific files: double  click 'All' and type 'ch1'.</li>
<li>Check/uncheck the Apply checkbox to observe how only the channel 1 data is being shifted accordingly.</li>
<li>Fold the Calibration panel (using the arrow button in the bottom-right corner).</li>
<li>Select the Solid_calibrator_data_1_1756994363_phasor_ch2.json file (left click on it).</li>
<li>Declare it as a calibration file (Right click - Calibration File).</li>
<li>In the calibration panel change the identifier to apply the calibration only to specific files: Change 'All' for 'ch2'.</li>
<li>The data is now calibrated, each channel with its own calibration. This can be done for any number of channels.</li>
</ol>
<h2 id="T4">Tutorial 4 – Masking</h2>
<ol start="0">
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Start GSLab.</li>
<li>Right-click in the empty space and select Load > Leica Falcon SnG.</li>
<li>Navigate into the Organoid folder and select the phasor_data folder.<br>This is a two-channel image of an intestinal organoid labeled with a membrane dye and a mitocondrial marker.<br>Courtesy of Hang Zhou, University of Ghent.</li>
<h3>Image tab – Load the mask</h3>
<li>Set the intensity range units to relative with the Relative checkbox.</li>
<li>Set the intensity range using the Auto button.</li>
<li>Set the lower value of the intensity range to 0.1 to exlude the unmodulated light component in the background.</li>
<li>Click on the Load mask button to and select the CellposeMask.png file. This is an 16bit integer value image from the automatical segmentation pipeline Cellpose. Each pixel is marked with an integer id that determines which cell it belongs to. GSlab assigns random colors to each object.</li>
<li>Check the Apply mk checkbox to apply the mask image to the data. Only the pixels inside the mask are being depicted</li>
<li>Check the invert checkbox to see how now only the pixels outside the mask are being depicted</li>
<li>Uncheck the invert checkbox again</li>
<h3>Export tab – Obtain object averaged parameters</h3>
<li>Uncheck all checkboxes except 'Pixel GS \& data'</li>
<li>Press Export LR button. A spreadsheet is generated for each file:<br>The pixel-wise intensity, phasor and image coordinates and lifetime measurements, these are one row for each pixel inside the mask.</li>
<li>Uncheck all checkboxes except 'Masked obj data'</li>
<li>Press Export LR button. A spreadsheet is generated for each file together with a label reference png:<br>The object-wise intensity, phasor and image coordinates and lifetime measurements, these are one row for each distinct object in the mask. The first column is the id assigned to the object which can be used to inspect the object location in the label reference png.</li>
</ol>
<h2 id="T5">Tutorial 5 – Automated phasor clustering </h2>
<ol start="0">
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Right-click in the empty white space and select Load > SimFCSref.</li>
<li>Navigate to the folder location for the downloaded SkinSlice and select the single file in the folder.<br>This is a XZ cross section of an unlabeled human skin biopsy taken at the NLOM lab at UCI.</li>
<h3>Image tab – Set the image dynamic range</h3>
<li>Uncheck the Relative checkbox to display the histogram in real counts instead of normalized intensity</li>
<li>In the Intensity threshold values, type 30 for the lower value field (press enter).</li>
<li>Slide the right slider down to about 1/8th of the range to reveal the structure in the epidermis at the cost of saturating the brighter pixels.</li>
<h3>Cluster tab – Perform automated clustering on the phasor plot</h3>
<li>GMM attempts to find the linear combination of K gaussian distributions that best fits the data.</li>
<li>Clicking on the plot to leave some cursors as starting points for the algorithm. The positions and sizes are not as important, the algorithm will tune them, but the total number of clusters will be set by the number of clusters. </li>
<li>Click on Train GMM button to generate the model. </li>
<li>The image will be colored according to the model results.</li>
<li>Contour lines will appear on the phasor plot, representing the Gaussian components.</li>
<li>Click on Contour separate clusters to observe the individual components on the phasor plot.</li>
<li>Click on Ellipse with % of data to display ellipses instead</li>
<li>Change the percentage to display bigger or smaller ellipses.</li>
<li>Click Apply GMM to reapply the model after changes to the image or phasor settings.</li>
<li>The Clear GMM button will clear the current model.</li>
<li>With Probability assign to color each pixel based on its mix of components.</li>
<li>Click Hard assign to color each pixel based on the highest component coefficient.</li>
<li>Check Blending to smooth color transitions.</li>
<li>Check Override magnitude for export to save GMM-clustered images instead of cursor-colored ones.</li>
<h3>Export tab – Save the results</h3>
<li>Click Output Folder to choose where to save the data.</li>
<li>Two checkboxes now include the GMM-colored option.</li>
<li>Uncheck all checkboxes except for Phasor with axes, Phasor Plot as, Intensity image, GMM-colored image, and Combine into single image.</li>
<li>Click Export LR to save.</li>
<li>One file will be exported, containing the grayscale intensity image, GMM-colored image, and phasor plot.</li>
<li>Uncheck Combine into single image.</li>
<li>Click Export LR again.</li>
<li>Now, three separate images should appear in the output folder: phasor plot, grayscale intensity, and GMM-colored image.</li>
</ol>
<h2 id="T6">Tutorial 6 – Phasor unmixing with nuclear dyes</h2>
<ol start="0">
<em>Attention: Ensure that the max harmonics is set to 2 in order to compute harmonics when loading<br>(Settings tab - max harmonics).<div style="height: 10px;"></div></em>
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Start GSLab.</li>
<li>Right-click in the empty space and select Load > SimFCS ref.</li>
<li>Select the 5 files from the NuclearDyes folder. <br>These are images of cell nuclei, 4 files have a single dye, the 5th contains all dyes, taken at the LFD, UCI:</li>
<ul style="margin:0;">
<li>AcO: single dye used Acridin Orange.</li>
<li>EtBr: single dye used Ethidium Bromide.</li>
<li>Nuc: single dye used NucBlue.</li>
<li>RoseB: single dye used Rose Bengal.</li>
<li>AllTogether: this dish was stained with all four dyes.</li>
</ul>
<li>Check/uncheck files in the list to see their contributions in the phasor plot.</li>
<li>Hover the mouse on the phasor plot to see the image contributions to the phasor plot.</li>
<li>The files can be rearranged for clarity: click on the file named ‘AllTogether’ to select it.</li>
<li>Right-click and select Move > Bot.</li>
<li>Click on the file named ‘EtBr’ to select it.</li>
<li>Right-click and select Move > Top.</li>
<li>We should currently have the files sorted in descending lifetime order with the mixture file in the bottom.</li>
<li>Check/uncheck files in the list to see their contributions in the phasor plot.</li>
<h3>Image tab – Control the rendering of the intensity image</h3>
<li>Slide the left slider up to about 1/10th of the range to exclude the pixels outside of the nuclei.</li>
<li>Slide the right slider down to about 1/3rd of the range to adjust the image display.</li>
<h3>Phasor tab – Filter the phasor data</h3>
<li>Change the Phasor filtering value to 7. Press Enter.</li> 
<li>Change the Times value to 2. Press Enter. </li>
<li>In the Measured magnitude section click on TauNorm. </li>
<h3>Display tab – Customize the phasor plot</h3>
<li>Check the Soft Masks.</li>
<li>Check/uncheck Normalize by file to observe the contribution of the narrower distributions</li>
<h3>Unmix tab – Perform unmixing of 4 components</h3>
<li>Click the + button 4 times to add 4 pure components on the universal circle.</li>
<li>Enter the values 0.5ns, 2ns, 5ns and 20ns respectively.</li>
<li>The quadrilateral delimits the pure component locations.</li>
<li>Check the options Export fraction im, Color components, Single image, and Export fraction x int.</li>
<li>Click Compute LR to launch the unmixing and save the files (in the output folder set in the Export tab).</li>
<li>The output is an image for each component with the color-coded unmixed photon fraction in each pixel.</li>
<li>Check Group by File.</li>
<li>Click Compute LR to launch the unmixing.</li>
<li>The output is an image for each file with the color-coded unmixed photon fraction in each pixel.</li>
<li>Check Export fraction csv.</li>
<li>Click Compute LR to launch the unmixing and export a csv file for each image with the unmixed photon fraction at each individual pixel.</li>
</ol>
<h2 id="T7">Tutorial 7 – Spectral phasor unmixing with spectrally resolved organelle dyes</h2>
<ol start="0">
<li><a href="https://doi.org/10.6084/m9.figshare.28067108" target="_blank">Download the tutorial files from FigShare.</a></li>
<h3>File tab – Load files into the software</h3>
<li>Start GSLab.</li>
<li>Right-click in the empty space and select Load > Zeiss lsm.</li>
<li>Select the file from the OrganelleDyes folder. This is a culture of cells loaded with 5 organelle dyes.<br>Courtesy of Leonel Malacrida and Florencia Irigoin, Universidad de la Rep&uacute;blica, Montevideo.</li>
<li>Hover over the phasor to see highlighted image regions:</li>
<li>Top right is the nuclear dye.</li>
<li>Bottom right is the membrane dye.</li>
<li>Bottom-left is the mitochondria dye.</li>
<li>Middle-left is the Golgi dye.</li>
<h3>Image tab – Control the rendering of the intensity image</h3>
<li>Slide the right slider down to about 1/2 of the range to adjust the image display.</li>
<h3>Phasor tab – Filter the phasor data</h3>
<li>Change the Phasor filtering value to 3. Press Enter. </li>
<li>Change the Times value to 1. Press Enter. </li>
<li>In the Measured magnitude section click on Phase. </li>
<li>Set the Color range to 0 and 1.</li>
<h3>Display tab – Customize the phasor plot</h3>
<li>Check the Soft Masks.</li>
<li>Set the Spectral band range to 450 and 700nm respectively (matching the acquisition spectral detector).</li>
<h3>File tab – Load theoretical spectra downloaded from Chroma</h3>
<li>Right-click in the empty space and select Load > Trace txt/csv.</li>
<li>Select the file from the SpectralExample folder. This is a list of the 5 emission spectra of the dyes.</li>
<li>Hover over the phasor to find the five emission spectra as small circles.</li>
<h3>Unmix tab – Perform unmixing of 5 components</h3>
<li>In the Source radio buttons select File.</li>
<li>The box on the left lists all files loaded. Check the 5 that correspond to the theoretical spectra of the dyes.</li>
<li>An irregular pentagon is formed delimiting the pure component locations.</li>
<li>Check the options Export fraction im, Color components, Single image, Export fraction x int, and Merge comps.</li>
<li>Click Compute LR to launch the unmixing and save the files (in the output folder set in the Export tab).</li>
<li>The output is an image for each component with the color-coded unmixed photon fraction in each pixel.</li>
<li>The component colors can be changed with the cursor colors in the Display tab.</li>
<li>We can go to the File tab, uncheck the pure component traces, go back to the Unmix tab and run Compute LR</li>
<li>This will create the unmixing data for just the selected file. </li>
</ol>


</div>

</body>

</html>
